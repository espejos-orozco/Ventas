<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <h:outputStylesheet name="./css/default.css"/>
        <h:outputStylesheet name="./css/cssLayout.css"/>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <!--font-family-->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i"/>

        <!-- For favicon png -->
        <link rel="stylesheet" type="image/icon" href="assets/logo/favicon.png"/>

        <!--font-awesome.min.css-->
        <link rel="stylesheet" href="assets/css/font-awesome.min.css"/>

        <!--linear icon css-->
        <link rel="stylesheet" href="assets/css/linearicons.css"/>

        <!--animate.css-->
        <link rel="stylesheet" href="assets/css/animate.css"/>

        <!--owl.carousel.css-->
        <link rel="stylesheet" href="assets/css/owl.carousel.min.css"/>
        <link rel="stylesheet" href="assets/css/owl.theme.default.min.css"/>

        <!--bootstrap.min.css-->
        <link rel="stylesheet" href="assets/css/bootstrap.min.css" />

        <!-- bootsnav -->
        <link rel="stylesheet" href="assets/css/bootsnav.css"/>	

        <!--style.css-->
        <link rel="stylesheet" href="assets/css/style.css"/>

        <!--responsive.css-->
        <link rel="stylesheet" href="assets/css/responsive.css"/>

        <!-- Cookies -->
        <script src="https://cdn.jsdelivr.net/npm/js-cookie@rc/dist/js.cookie.min.js"></script>

        <!-- title of site -->
        <title>Ventas Online</title>
    </h:head>

    <h:body>

        <div id="top">
            <!-- top-area Start -->
            <div class="top-area">
                <div class="header-area">
                    <!-- Start Navigation -->
                    <nav class="navbar navbar-default bootsnav  navbar-sticky navbar-scrollspy"  data-minus-value-desktop="70" data-minus-value-mobile="55" data-speed="1000">
                        <div class="container">            
                            <!-- Start Atribute Navigation -->
                            <div class="attr-nav">
                                <ul>
                                    <li class="nav-setting">
                                        <a href="#" id="btn-sesion"><span class="lnr lnr-user"></span></a>
                                    </li><!--/.search-->
                                    <li class="dropdown">
                                        <a href="http://localhost:8080/Ventas/faces/carrito.xhtml" class="dropdown-toggle" data-toggle="dropdown" >
                                            <span class="lnr lnr-cart"></span>
                                            <span class="badge badge-bg-1" id="count-car">0</span>
                                        </a>
                                    </li><!--/.dropdown-->
                                </ul>
                            </div><!--/.attr-nav-->
                            <!-- End Atribute Navigation -->

                            <!-- Start Header Navigation -->
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
                                    <i class="fa fa-bars"></i>
                                </button>
                                <a class="navbar-brand" href="http://localhost:8080/Ventas/">furn.</a>

                            </div><!--/.navbar-header-->
                            <!-- End Header Navigation -->

                            <!-- Collect the nav links, forms, and other content for toggling -->
                            <div class="collapse navbar-collapse menu-ui-design" id="navbar-menu">
                                <ul class="nav navbar-nav navbar-center" data-in="fadeInDown" data-out="fadeOutUp">
                                    <li class=" scroll active"><a href="#home">home</a></li>
                                    <li class="scroll"><a href="#new-arrivals">new arrival</a></li>
                                    <li class="scroll"><a href="#feature">features</a></li>
                                    <li class="scroll"><a href="#blog">blog</a></li>
                                    <li class="scroll"><a href="#newsletter">contact</a></li>
                                </ul><!--/.nav -->
                            </div><!-- /.navbar-collapse -->
                        </div><!--/.container-->
                    </nav><!--/nav-->
                    <!-- End Navigation -->
                </div><!--/.header-area-->
                <div class="clearfix"></div>

            </div><!-- /.top-area-->
            <!-- top-area End -->
        </div>

        <div id="content" class="center_content">
            <ui:insert name="content">Content</ui:insert>
        </div>

        <div id="bottom">
            <!--footer start-->
            <footer id="footer"  class="footer">
                <div class="container">
                    <div class="hm-footer-copyright text-center">
                        <div class="footer-social">
                            <a href="#"><i class="fa fa-facebook"></i></a>	
                            <a href="#"><i class="fa fa-instagram"></i></a>
                            <a href="#"><i class="fa fa-linkedin"></i></a>
                            <a href="#"><i class="fa fa-pinterest"></i></a>
                            <a href="#"><i class="fa fa-behance"></i></a>	
                        </div>
                        <p>
                            &copy;copyright. designed and developed by <a href="https://www.themesine.com/">themesine</a>
                        </p><!--/p-->
                    </div><!--/.text-center-->
                </div><!--/.container-->

                <div id="scroll-Top">
                    <div class="return-to-top">
                        <i class="fa fa-angle-up " id="scroll-top" data-toggle="tooltip" data-placement="top" title="" data-original-title="Back to Top" aria-hidden="true"></i>
                    </div>

                </div><!--/.scroll-Top-->

            </footer><!--/.footer-->
            <!--footer end-->
        </div>

        <!-- Include all js compiled plugins (below), or include individual files as needed -->

        <script src="assets/js/jquery.js"></script>

        <!--modernizr.min.js-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

        <!--bootstrap.min.js-->
        <script src="assets/js/bootstrap.min.js"></script>

        <!-- bootsnav js -->
        <script src="assets/js/bootsnav.js"></script>

        <!--owl.carousel.js-->
        <script src="assets/js/owl.carousel.min.js"></script>


        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>


        <!--Custom JS-->
        <script src="assets/js/custom.js"></script>

        <script>
            $(document).ready(function () {
                calcularCarrito();
                let locationActual = window.location.toString();

                //Carrito
                if (locationActual.indexOf("carrito.xhtml") > -1) {
                    obtenerCarrito();

                }
            });

            function obtenerCarrito() {
                let carrito = JSON.parse(Cookies.get('carrito'));
                $(document).find("#list-group-carrito .list-item-carrito").remove();
                carrito.forEach(function (c) {
                    $(document).find("#list-group-carrito").append('<li class="list-group-item row list-item-carrito">' +
                            '<div class="col-lg-9 col-md-9">#' + c.producto_id + '-' + c.variante_producto_id + '# ' + c.nombre + ' ' + c.descripcion + ' $' + c.precio + ' ' + '</div>' +
                            '<div class="col-lg-3 col-md-3"><button class="btn btn-block btn-danger btn-eliminar-carrito" variante_producto_id = "'+c.variante_producto_id+'" producto_id = "'+c.producto_id+'">Eliminar</button></div></li>')
                });
            }

            function calcularCarrito() {
                if (Cookies.get('carrito') == undefined) {
                    Cookies.set('carrito', JSON.stringify([]));
                }
                let carrito = JSON.parse(Cookies.get('carrito'));
                $(document).find("#count-car").text(carrito.length);
                
                if(carrito != 0){
                    $(document).find("#row-pagar").attr("hidden", false);
                }else{
                    $(document).find("#row-pagar").attr("hidden", true);
                }
                
            }
            
            $(document).on("click", ".btn-eliminar-carrito", function(){
                let list_group_item = $(this).closest("li");
                let producto_id = $(this).attr("producto_id");
                let variante_producto_id = $(this).attr("variante_producto_id");
                let carrito = JSON.parse(Cookies.get('carrito'));
                let nuevo_carrito = new Array();
                carrito.forEach(function(c){
                    if(c.producto_id != producto_id){
                        if(c.variante_producto_id != variante_producto_id){
                            nuevo_carrito.push(c);
                        }
                    }
                });
                
                Cookies.set('carrito', JSON.stringify(nuevo_carrito));
                
                calcularCarrito();
                obtenerCarrito();
                
            });
        </script>

    </h:body>

</html>
